<!DOCTYPE html>
<!-- Replace these import links with links to files hosted on your own server -->
<script src="//polymerstaticfilesfortesting.appspot.com/bower_components/webcomponentsjs/webcomponents.min.js"></script>

<link rel="import" href="//polymerstaticfilesfortesting.appspot.com/bower_components/polymer/polymer.html">
<link rel="import" href="//polymerstaticfilesfortesting.appspot.com/bower_components/font-roboto/roboto.html">
<link rel="import" href="//polymerstaticfilesfortesting.appspot.com/bower_components/paper-input/paper-input.html">
<link rel="import" href="//polymerstaticfilesfortesting.appspot.com/bower_components/paper-button/paper-button.html">
<link rel="import" href="//polymerstaticfilesfortesting.appspot.com/bower_components/paper-checkbox/paper-checkbox.html">
<link rel="import" href="//polymerstaticfilesfortesting.appspot.com/bower_components/paper-radio-group/paper-radio-group.html">
<link rel="import" href="//polymerstaticfilesfortesting.appspot.com/bower_components/paper-radio-button/paper-radio-button.html">
<link rel="import" href="//polymerstaticfilesfortesting.appspot.com/bower_components/paper-input/paper-input-decorator.html">

<style>
  body {
    font-family: 'RobotoDraft', sans-serif;
    padding: 0;
  }
  h3 {
    text-align: center;
    margin: 0;
  }
  paper-button {
    margin: 0;
    margin-top: 10px;
  }
  paper-button + paper-button {
    margin-left: 8px;
  }
  .sidebar {
    -moz-box-sizing: border-box;
    box-sizing: border-box;
    overflow-y: auto;
    padding: 12px;
    position: absolute;
    width: 100%;
  }
  .bottom {
    bottom: 0;
    position: absolute;
  }
  .branding-below {
    bottom: 100px;
    top: 0;
  }
  .branding-text {
    left: 7px;
    position: relative;
    top: 3px;
  }
  .col-contain {
    overflow: hidden;
  }
  .col {
    float: left;
    width: 50%;
  }
  #dest {
    margin-top: 42px;
  }
  .logo {
    vertical-align: middle;
  }
  .width-100 {
    width: 100%;
  }
  .error {
    color: #dd4b39;
    font-size: small;
    margin-top: 8px;
  }
  .gray {
    color: #777;
  }
  .colored {
    background: #4285f4;
    color: #ffffff;
  }
</style>


<script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js">
</script>


<div class="sidebar branding-below">
  <div class="col-contain">
    <div>
      <h3>Selected text</h3>
      <paper-radio-group id="origin">
        <!-- <paper-radio-button name="auto" id="radio-origin-auto" label="Auto-detect"></paper-radio-button> -->
          <paper-radio-button name="en" id="radio-origin-en" label="English"></paper-radio-button>
          <paper-radio-button name="fr" id="radio-origin-fr" label="French"></paper-radio-button>
          <paper-radio-button name="de" id="radio-origin-de" label="German"></paper-radio-button>
          <paper-radio-button name="ja" id="radio-origin-ja" label="Japanese"></paper-radio-button>
          <paper-radio-button name="es" id="radio-origin-es" label="Spanish"></paper-radio-button>
      </paper-radio-group>
      <br>
      <form onsubmit="getCheckboxValues(this);">
      <h3>Translate into</h3>
      <h5 style="text-align:center; margin-top:0px">(choose up to 10)</h5>
    <div class="row" style="margin-bottom:10px">
      <div class="col"><paper-checkbox class="source" label="Afrikaans" name="language" value="af"></paper-checkbox></div>
      <div class="col"><paper-checkbox class="source" label="Albanian" name="language" value="sq"></paper-checkbox></div>
   </div>
   <div class="row" style="margin-bottom:10px">
      <div class="col"><paper-checkbox class="source" label="Arabic" name="language" value="ar"></paper-checkbox></div>
      <div class="col"><paper-checkbox class="source" label="Azerbaijani" name="language" value="az"></paper-checkbox></div>
    </div>
    <div class="row" style="margin-bottom:10px">
      <div class="col"><paper-checkbox class="source" label="Basque" name="language" value="eu"></paper-checkbox></div>
      <div class="col"><paper-checkbox class="source" label="Bengali" name="language" value="bn"></paper-checkbox></div>
    </div>
    <div class="row" style="margin-bottom:10px">
      <div class="col"><paper-checkbox class="source" label="Belarusian" name="language" value="be"></paper-checkbox></div>
      <div class="col"><paper-checkbox class="source" label="Bulgarian" name="language" value="bg"></paper-checkbox></div>
    </div>
    <div class="row" style="margin-bottom:10px">
      <div class="col"><paper-checkbox class="source" label="Catalan" name="language" value="ca"></paper-checkbox></div>
      <div class="col"><paper-checkbox class="source" label="Chinese" name="language" value="zh-TW"></paper-checkbox></div>
    </div>
    </form>
    <!-- <div class="col">
      <h3>Translate into</h3>
      <paper-radio-group id="dest" selected="ja">
        <paper-radio-button name="en" id="radio-dest-en" label="English"></paper-radio-button>
        <paper-radio-button name="fr" id="radio-dest-fr" label="French"></paper-radio-button>
        <paper-radio-button name="de" id="radio-dest-de" label="German"></paper-radio-button>
        <paper-radio-button name="ja" id="radio-dest-ja" label="Japanese"></paper-radio-button>
        <paper-radio-button name="es" id="radio-dest-es" label="Spanish"></paper-radio-button>
      </paper-radio-group>
    </div> -->
    </div>
  </div>
  <br>
  <div id="button-bar">
    <paper-button class="colored" id="run-translation">Translate?</paper-button>
  </div>
  <paper-input-decorator floatingLabel label='Here is your "translation":'>
    <textarea class="width-100" id="translated-text" rows="8"></textarea>
  </paper-input-decorator>


   <!-- <paper-checkbox id="save-prefs" label="Use these languages by default"></paper-checkbox> -->


  <div id="button-bar">
    <paper-button class="colored" id="insert-text">Insert</paper-button>
  </div>

</div>

<div class="sidebar bottom">
  <img alt="Add-on logo" class="logo" width="27" height="27"
      src="https://www.gstatic.com/images/branding/product/1x/translate_48dp.png">
  <span class="gray branding-text" style="font-size:14px">Original Translate sample by Google</span>
  <br>
  <img alt="Add-on logo" class="logo"
      src="http://i63.tinypic.com/14uv0at.jpg">
  <span class="gray branding-text" style="font-size:14px">Remixed by Melissa Mejias Parker</span>
</div>

<script>
  /**
   * On document load, assign click handlers to each button and try to load the
   * user's origin and destination language preferences if previously set.
   */
  $(function() {
    $('#run-translation').click(runTranslation);
    $('#insert-text').click(insertText);
    google.script.run.withSuccessHandler(loadPreferences)
        .withFailureHandler(showError).getPreferences();
  });
  /**
   * Callback function that populates the origin and destination selection
   * boxes with user preferences from the server.
   *
   * @param {Object} languagePrefs The saved origin and destination languages.
   */
  function loadPreferences(languagePrefs) {
    if (languagePrefs.originLang) {
      $('#origin').prop('selected', languagePrefs.originLang);
    }
    if (languagePrefs.destLang) {
      $('#dest').prop('selected', languagePrefs.destLang);
    }
  }
  
  /*
  function pushValues(){
   $("paper-checkbox:checkbox[name=language]:checked").each(function(){
   somelangs.push($(this).val());
   });
   somelangs.push($(origin));
   };
   */
   
   
  /**
   * Runs a server-side function to translate the user-selected text and update
   * the sidebar UI with the resulting translation.
   */
   
  function runTranslation() {
    this.disabled = true;
    $('#error').remove();
    var origin = $('#origin').prop('selected');
    var dest = $('#dest').prop('selected');
    var savePrefs = $('#save-prefs').prop('checked');
    
    /*
    var somelangs = $(".source").prop("checked");
    somelangs.replace("language=","");
    somelangs.replace("&"," ");
    somelangs = somelangs.split(" ");
    somelangs.unshift(origin);
    somelangs.push(origin);
    */
    
        .withSuccessHandler(
          function(translatedText, element) {
            $('#translated-text').val(translatedText);
            element.disabled = false;
          })
        .withFailureHandler(
          function(msg, element) {
            showError(msg, $('#button-bar'));
            element.disabled = false;
          })
        .withUserObject(this)
        .runTranslation(origin, savePrefs);
        
  }
  /**
   * Runs a server-side function to insert the translated text into the document
   * at the user's cursor or selection.
   */
  function insertText() {
    this.disabled = true;
    $('#error').remove();
    google.script.run
        .withSuccessHandler(
          function(returnSuccess, element) {
            element.disabled = false;
          })
        .withFailureHandler(
          function(msg, element) {
            showError(msg, $('#button-bar'));
            element.disabled = false;
          })
        .withUserObject(this)
        .insertText($('#translated-text').val());
  }
  /**
   * Inserts a div that contains an error message after a given element.
   *
   * @param msg The error message to display.
   * @param element The element after which to display the error.
   */
  function showError(msg, element) {
    var div = $('<div id="error" class="error">' + msg + '</div>');
    $(element).after(div);
  }
</script>
